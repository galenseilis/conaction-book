# Correlational Sufficiency of an Isolation by Distance Model of Mountain Pine Beetle in Western North America

In this chapter we describe an application of the multilinear Pearson correlation coefficient in the science of molecular ecology.

## Introduction
For three random variables, $X$, $Y$, and $Z$, we can consider the proposition that $X$ and $Y$ are independent conditioned on $Z$, denoted by $X \perp\!\!\!\!\perp Y | Z$.  If $Z$ is controlled for, then $X$ and $Y$ should be found to be independent. Testing $X \perp\!\!\!\!\perp Y$ while stratifying by $Z$ is an approach to evaluating this proposition. Stratification can be done discretely by grouping the values of $X$ and $Y$ into different levels of $Z$, and then estimating the measure dependence between $X$ and $Y$ within those groupings. While binning data into a discrete partition can introduce binning error, it can be an effective way of handling apparent discontinuities in a data set.  A second approach to stratification called \textit{partialling} is to find continuous functions $X \approx f(Z)$ and $Y \approx g(Z)$, and then examine whether $[X-f(Z)] \perp\!\!\!\!\perp [Y-g(Z)]$. When $f$ and $g$ are linear, and we compute the Pearson correlation coefficient on their residuals, which has been called *partial correlation* (@fisher1924). Partialling with linear models will lead to the partial correlation coinciding with the conditional correlation when the random variables follow certain joint distributions such as the multivariate normal distribution (@Baba2004), but in general a careful consideration of how the conditional expectation is being modelled is needed. These two approaches to stratifying are compatible in the sense that they can be used within the same analysis.

Multilinear Pearson correlation can be used to indicate multilinear dependence. Since multilinear dependence is mutually exclusive with independence, we can use multilinear Pearson correlation as evidence of dependence. A multilinear Pearson correlation score of zero does not imply independence however, so the inference is one-sided. Because the multilinear Pearson correlation is defined partly in terms of expectation operators, we can condition the correlation score on other variables. In this way we can compute conditional correlations at discrete levels of a random variable, or partial and semi-partial\footnote{The distinction between a partial correlation and a semi-partial correlation pertains to whether the same set of variables are used to model $X$ as are used to model $Y$. In the semi-partial case one might consider  $X \ind Y | Z,U$ and find that $[X - f(Z)] \ind [Y -  g(U)]$ is true for $Z \neq U$. Even more complicated conditional independence exist such as $[X - f(Z)] \ind [Y -  g(Z,U)]$.} correlation coefficients when we can model the conditional dependence with functions. We can therefore use multilinear Pearson correlation coefficients to estimate the existence of multilinear forms of conditional independence. When a collection of propositions about (in)dependence or conditional (in)dependence are tested with correlation statistics, and those correlations seem to agree with the hypothetical statements, we will call the propositions *correlationally sufficient.

Mountain pine beetle (*Dendroctonus ponderosae*) (Figure \ref{fig:pinebeetle}(a)) is a species of bark beetle native to western Canada, the United States of America, and Mexico \cite{Furniss1977}. It predates on a variety of tree species, and especially pine.  According to a manual published by the United States Department of Agriculture Forest Service in 1977, mountain pine beetle had been observed attacking various species of pine trees including *Pinus contorta*, *Pinus lambertiana*, *Pinus monticola*, *Pinus ponderosa*, *Pinus albicaulis*, *Pinus aristata*, *Pinus balfouriana*, *Pinus coulteri*, *Pinus edulis*, *Pinus flexilis*, and *Pinus monophylla* (@Furniss1977). Within British Columbia the most common species of host for mountain pine beetle is lodgepole pine (*Pinus contorta*)(@burleigh2014). A couple of indicators of mountain pine beetle attacks on trees include pitch tubes (Figure \ref{fig:pinebeetle}(b)) which are a result of the host tree response (@burleigh2014), and areas of dead (especially pine) trees on a landscape (Figure \ref{fig:pinebeetle}(c)). Approximately 18.3 million hectares of British Columbia were affected by a mountain pine beetle epidemic that began in the early 1990's (@Corbett2015). This left a large negative impact on the forest industry of British Columbia, damaging over half of the merchantable pine in the province, which has been forecasted to result in a 57.37 billion dollar loss in GDP of the next few decades (@Corbett2015). The epidemic disrupted the habitat of numerous species of birds and mammals (@Saab2014). It is worthwhile to continue studying the mountain pine beetle post-epidemic to understand how to prevent and mitigate further economic and environmental disturbances from mountain pine beetle and similar forest pests.

::: {#fig-pine-beetle layout-ncol=2}

![Mountain pine beetle specimen (Public Domain)](https://upload.wikimedia.org/wikipedia/commons/e/e9/Pine_beetle_pitch_tube.jpg)

![Pitch tubes caused by beetles boring into the bark (CC BY-SA 3.0)](https:/inaturalist-open-data.s3.amazonaws.com/photos/8048768/original.jpg)

![Mountain pine beetle damage in Rocky Mountain National Park in 2012 (CC BY-SA 3.0)](https://upload.wikimedia.org/wikipedia/commons/5/52/Mountain_pine_beetle_damage_in_Rocky_Mountain_National_Park.jpg)

Mountain pine beetle have a substantial impact on individual trees and landscapes.
:::

Isolation by distance (IBD)  is a hypothesis that can be made about a collection of populations (i.e. a metapopulation) that will potentially interbreed \cite{Wright1943}. Specifically, a metapopulation exhibits IBD if its members are more genetically dissimilar the further apart they are from each other, which is motivated by the notion that mere distance between populations can serve as a gradual contribution to reproductive isolation. Mountain pine beetle has been analyzed for distinct populations of mountain pine beetle in \cite{booneunpublished, samarasekera2012}  using software such as STRUCTURE \cite{Pritchard2000} and BAPS \cite{Corander2003}, and was found to have a North-South clustering pattern \cite{samarasekera2012}. Subclusters within the northern and southern clusters are also supported \cite{samarasekera2012}. In \cite{booneunpublished} evidence of four clusters (see Figure \ref{fig:geo_cluster_dist}(a)) was also found, however \cite{samarasekera2012} considered the geographic scope of western Canada while \cite{booneunpublished} considered the geographical scope of western North America.  After identifying populations of mountain pine beetle, \cite{samarasekera2012} found evidence of IBD using linear regression.\\

\begin{figure}[H]
	\centering
	\begin{tabular}{cc}
	(a) & (b)\\
		\includegraphics[scale=0.5]{./IBD_figures/lat_long_STRUCTURE_clusters.pdf} & \includegraphics[scale=0.5]{./IBD_figures/lat_long_200km_radius.pdf} \\
	\end{tabular}
	\caption{Geographic distribution of mountain pine beetle samples in western North America. (a) Geographic scatter plot with Gaussian kernel density estimated distributions  \cite{Rosenblatt1956, Parzen1962} stratified by genetic clusters identified by STRUCTURE in \cite{booneunpublished}. (b) Geographic scatter plot with bivariate Gaussian kernel density estimated distributions \cite{Rosenblatt1956, Parzen1962} and marginal histograms. Each sample point has a disk with a 200 km radius drawn around it.}
	\label{fig:geo_cluster_dist}
\end{figure}


A question that remains under-addressed is whether host selection is independent from the genetic variation among mountain pine beetle populations. Previous studies found that allozyme \footnote{Two or more enzymes are \textit{allozymes} or \textit{alloenzymes} if they differ structurally, but not in terms of their biochemical function. This might be considered in a qualitative fashion as enzymes may not have the same enzyme activity level under equivalent chemical conditions.} variation is confounded by geography \cite{Sturgeon1986, Langor1991}. Namely that the isolation by distance effect observed in mountain pine beetle may be confounding our understanding of dependence between host selection and genetic variability of mountain pine beetle. One approach is to perform an analysis of molecular variance conditioned on the geographical distances being small. This approach was used in \cite{booneunpublished} where they conditioned the maximum distance to be 200 km (visualized in Figure \ref{fig:geo_cluster_dist}(b)), and did not find statistically significant ($\alpha=0.05$) results for host selection effects with this approach. Their choice of 200 km, and whether the corrections they performed (see \cite{Weir1984}) were sufficient to account for the unbalanced group sizes, may or may not have affected the analysis outcome. Since no statistical procedure is without assumptions, it is desirable to perform multiple analyses under different assumptions to see if there is consilience (i.e. convergence of evidence).

In this application we considered whether there is correlational sufficiency of certain IBD models stratified by clusters identified in \cite{booneunpublished} using STRUCTURE.  The first hypothesis was whether the IBD models were correlationally sufficient in their exogeneity. This term, \textit{exogenous}, comes from Economics. It is a hypothesis that the errors of a model are independent of the explanatory variables (@wooldridge2009). When this does not occur, it is an indication that the model has been improperly specified. When a model is not exogenous, it is called \textit{endogenous}. The second question was whether the residuals of the IBD models appear to be independent of host selection along with potential covariates related to temperature, phase changes of water, and elevation. We also examine these hypotheses via assessing correlational sufficiency.

In order to do this we first hypothesized a functional relationship between the genetic dissimilarity and the geographical distance based on existing literature.  \cite{Peterson1998} summarizes slopes and intercepts of IBD models for numerous insect species in which a linear model between the log of gene flow and the log of geographic distances were computed. This motivates the use of a linear model to begin with. Similarly, \cite{Rousset1997} suggests the modelling $\frac{F_{ST}}{1- F_{ST}}$ against the log of the geographic distances, which is also used in \cite{booneunpublished}. We adopt the variable \texttt{fst\_score}\footnote{We call it a 'score' rather than a distance because it does not appear to satisfy all of the axioms of a metric, namely the triangle inequality.} in our analysis to be the pairwise $F_{ST}$ as calculated in the GenAlEx plugin for Excelâ„¢ (@PEAKALL2006) to represent the degree of genetic differentiation between populations.

## Dataset

Because we used the same dataset as @booneunpublished, the underlying materials and methods are the same. However, since \cite{booneunpublished} is currently unpublished we will give some description the dataset's properties as they were provided to us.

The dataset as provided constituted a GenAlEx6.5 software analysis, a summary of the sampled sites, and an extensive collection of climate-related variables paired to the site locations. Two variables of particular importance are the pairwise Fst scores as calculated by GenAlEx6.5, and the geolocations in terms of latitude and longitude. The geolocations were used in our analysis to calculate intersite distances as the arc lengths on a sphere. The climate-related data contained monthly and annual measurements related to temperature, pressure, and precipitation.\\

We are grateful to Dr. Brent Murray for provided this dataset to us along with the \cite{booneunpublished} manuscript. We are also grateful to the teams of people that participated in obtaining and curating such a large and rich dataset as acknowledged in @booneunpublished.

## Data Analysis

Originally we had intended to perform equation-by-equation ordinary least squares regression (EBE-OLS), but upon examination of the histograms (as found in Figure \ref{fig:cluster_regression}) of `fst_score` and `ln(geo_dist)` it became apparent that normality and homoschedasticity assumptions were not met. Strong violations of these assumptions imply that EBE-OLS is no longer guaranteed to be unbiased or the most efficient estimator of the linear regression parameters (@ohnson2007). Instead we used EBE iteratively-reweighted least squares (IRLS) (@Lawson1961) with a Huber loss (@Huber1964) using the \texttt{statsmodels 0.13.1} Python package to provide outlier-robust estimates of the regression parameters and residuals (see Appendix sections \ref{sec:ibdmodelsummaries} and \ref{sec:ibdevalplots} for model summaries and diagnostic plots). The fitted linear models are plotted in each panel of Figure \ref{fig:cluster_regression} along with the Pearson correlation, coefficient of determination and a p-value computed with the \texttt{scipy.stats.pearsonr} command (@Virtanen2020).  This command assumes a null hypothesis that the two variables follow a bivariate normal distribution, implying that the correlation coefficient follows a sampling density of $f(r) = \frac{(1 - r^2)^{\frac{n}{2} - 2}}{B(\frac{1}{2}, \frac{n}{2} - 1)}$ where $r$ is the Pearson correlation, $n$ is the sample size, and $B$ is the beta function \cite{Student1908}. Therefore p-values on Figure \ref{fig:cluster_regression} should be interpreted as the two-tailed likelihood of the data under the assumption of  being sampled from this null distribution.

Beyond mere non-normality, the data distributions in Figure \ref{fig:cluster_regression} show some unusual features. One is exemplified by the NL vs SW plot, but possibly present to some degree in other pairs such as NU vs SW and within SW. There appears to be more than one grouping in the data even after clustering. This suggests that the clustering is not fully accounting for the genetic distribution of microsatellites. The second unusual feature is that some of the plots, within NL, within NU, and within SE have skewed left tails along the axis of log geographic distance. Lastly, the shape of the connected components under visual inspection seem to be hinting at a bend in the data such as in NL vs NU or within SE, which may be an indication that the relationship between `fst_score` and `ln(geo_dist)` is non-linear.


\begin{figure}[H]
	\centering
	\begin{tabular}{ccc}
		\tiny Within NL & \tiny NL vs NU &  \tiny  NL vs SW \\
		\includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_NL_vs_NL.pdf} & \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_NL_vs_NU.pdf} & \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_NL_vs_SW.pdf} \\
		\tiny Within NU & \tiny  NU vs SW & \tiny SE vs NL \\
		 \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_NU_vs_NU.pdf} & \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_NU_vs_SW.pdf} & \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_SE_vs_NL.pdf} \\
		 \tiny SE vs NU &\tiny  Within SE & \tiny  SE vs SW \\
		\includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_SE_vs_NU.pdf} & \includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_SE_vs_SE.pdf} &
		\includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_SE_vs_SW.pdf}\\
		\tiny Within SW &  & \\
		\includegraphics[scale=0.3]{./IBD_figures/IBD_jointplot_SW_vs_SW.pdf} \\
	\end{tabular}
	\caption{Isolation-by-distance plots of pairwise Fst scores (\texttt{fst\_score}) vs the natural log of the geographic (shortest spherical arc) distance in kilometres (\texttt{ln(geo\_dist)}). The subplots are stratified by pairs of clusters identified by STRUCTURE. (NL) North Lower. (NU) North Upper. (SW) South Western. (SE) South Eastern.}
	\label{fig:cluster_regression}
\end{figure}

We wanted to include some potential covariates from the climate data that we were provided. We also wanted to evaluate whether we could reduce the dataset down to a small number of dimensions without losing much information about the original dataset. The multilinear correlation methodology we wished to use can be computed on different combinations of variables to learn about the dependence between particular combination of variables, but with over 200 variables that entails over $2^{200} - 201$ possible combinations. Thus we were motivated to look for ways to reduce the set of hypotheses to examine.\\

We performed a principal components analysis on the standardized scores of the site-level data as part of an exploratory data analysis. Figure \ref{fig:climatepca}(a) indicates that approximately 20-30 components would be needed to be kept to preserve a large majority of the variation in the data, suggested that the principal components are not efficient at compressing the data. Figures \ref{fig:climatepca}(b) and \ref{fig:climatepca}(c) confirms for us that the initial basis vectors point in various directions on the plane spanned by the first two principal components. Visual inspection of Figure \ref{fig:climatepca} suggests the NU cluster and the SW are linearly separable on the plane, and perhaps SE from SW, but most clusters do not appear to be easily separated for other pairings.

\begin{figure}[H]
	\centering
	\begin{tabular}{cc}
	(a) & (b) \\
	\includegraphics[scale=0.45]{./climate_pca/elbow_plot_traiphil_pca.pdf} & \includegraphics[scale=0.38]{./climate_pca/triaphil_pca_plot.pdf}  \\
	\end{tabular}
	
	\begin{tabular}{c}
	(c) \\
	\includegraphics[scale=0.53]{./climate_pca/triaphil_pca_labels_plot.pdf}
	\end{tabular}
	\caption{PCA of site location data paired with climate data. (a) Scree plot of singular values with first component explaining approximately 17 percent of the total variance. (b) Biplot of variables with all sites visible, colour-coded by the clusters provided by \cite{booneunpublished}. Marginal Gaussian kernel density estimates are included \cite{Rosenblatt1956, Parzen1962}. (c) Close up of biplot with the variable labels added to the arrow tips.}
	\label{fig:climatepca}
\end{figure}

To ameliorate the issue of too many candidate hypotheses, we took another approach \textit{via} principal components analysis. Most of the variables were explicitly about various annual, seasonal, and monthly scores related to (1) temperature and (2) phase changes in water. We annotated each of the climate variables as either having more to do temperature, phase changes of water, or neither. We labelled the group of variables related to temperature as \texttt{temperature} and the group of variables to phase changes of water as \texttt{precipitation}. By grouping the variables semantically we expected that variation in their first principal component would be ostensibly related to their semantic label, and that subsequent calculations of correlations with these variables would also be ostensibly related to the semantic label. Because we would not be computing the multilinear correlation on the original variables tied to a single site, but rather on scores tied to pairs of sites, we chose the absolute difference in these climate variables as new features to satisfy this requirement.\footnote{If we had continued with differences in climate variable scores instead, we would have had an issue with the scores being antisymmetric. Thus we would have had to choose between the upper vs lower triangle of the pairwise difference matrix, which seemed needlessly arbitrary.}

We also stratified the climate-related variables by pairs of clusters before performing principal components analysis on them so that when we computed the correlations between climate-related principal components and the IBD model residuals, they would have the same discrete conditioning as the pairwise \texttt{fst\_score} values. This approach may also have reduced the amount of variation in the principal components that was due to geographic distance, however we account for the possibility of the principal components being partly explained by geographic distance in our interpretation of the multilinear correlation scores. The resulting first principal components's are labelled as \texttt{Temperature\_PC} and \texttt{Precipitation\_PC}, and their explained variance ratios within each pair of clusters is summarized in Table \ref{tab:expvarpcaclimate}.

\begin{table}[H]
\centering
\caption{Explained variance ratios of first principal components of temperature and precipitation variable groups stratified by cluster pair.}
\begin{tabular}{lll}
\hline
Cluster Pair & Explained & Explained \\
 & Variance & Variance \\
  & Ratio & Ratio \\
 & \texttt{Temperature\_PC} & \texttt{Precipitation\_PC} \\
 \hline
Within NL & 0.58943674 &  0.22945464 \\
NL vs NU & 0.50543862 &  0.24115797 \\
NL vs SW & 0.53261144 &  0.23811749 \\
Within NU & 0.50923444 &  0.33917943 \\
NU vs SW & 0.53237635 &  0.27474814 \\
SE vs NL & 0.55363292 &  0.26139871 \\
SE vs NU & 0.54086253 &  0.28579717 \\
Within SE & 0.65255971 &  0.40494985 \\
SE vs SW & 0.4742398 &  0.25735202 \\
Within  SW & 0.6142342 &  0.34369012 \\
\hline
\end{tabular}
\label{tab:expvarpcaclimate}
\end{table}

Table \ref{tab:expvarpcaclimate} shows that most cluster pairs had around 50-60 percent total variance of their temperature differences explained by \texttt{Temperature\_PC}, and about 20-30 percent total variance of their water-related phase change differences explained by \texttt{Precipitation\_PC}. Especially for the temperature variables, this is a marked improvement over the approximately 17 percent total variation explained by the first principal component in Figure \ref{fig:climatepca}. While we have lost a lot of information with this compression, it adds two potential covariates related to climate to the analysis instead of over 200 potential covariates.\\

To asses the correlational sufficiency of the exogeneity of the IBD models, we computed the pairwise correlation between \texttt{residuals} and \texttt{ln(geo\_dist)} stratified by cluster pair. See Table \ref{tab:endogencorrs} for a summary of these statistics. We did not find any statistically significant ($\alpha=0.05$) correlations after correction for multiple tests, however we noted that the pre-corrected correlation between NL and SW was significant at this level. However, the effect size of this correlation was only 0.14. Therefore the models appear to be correlationally sufficient for exogeneity according to a pairwise correlation analysis.\\

For the multilinear correlation analysis to estimate correlational sufficiency we used IBD model residuals (\texttt{residuals}), host selection distance (\texttt{Host})\footnote{We operationalized host selection distance to be an indicator function. If the hosts were the same, we assigned a score of zero for \texttt{Host}. If they were different host species, we assigned 1 to the value of \texttt{Host}.}, geographic log-distance \linebreak (\texttt{ln(geo\_dist)}), the first temperature-difference-related principal component\linebreak (\texttt{Temperature\_PC}), and the first phase-change-of-water-related principal component\linebreak (\texttt{Precipitation\_PC}). With these six variables there are 57 correlation hypotheses that could be tested on each cluster pair, amounting to 570, however many of them are not directly related to our research questions. And it would be desirable to minimize the number of hypotheses tested to conserve statistical power. Since we were interested in the correlational sufficiency of the IBD models, we looked at a subset of correlations that always included always included \texttt{redisuals} and \texttt{Host} among the considered variables. This allowed us to compute only 16 correlation coefficients per cluster pair, entailing the calculation of 160 correlation coefficients among the 10 pairs of clusters.\\

Within each cluster pair the multilinear Pearson correlations were calculated with an estimated p-value using a permutation test using 10 000 resamplings, which tests a null hypothesis of exchangeability. As cited by @Serafino2016, all independent and identically distributed random variables are exchangeable. Thus a strongly inexchangeable collection of random variables entails that the random variables are either dependent and/or non-identical. This is a weak condition, but a substantially-non-zero multilinear Pearson correlation score suggests dependence anyway. Some of the p-values were zero because they were observed zero times, however we know that there exists at least one permutation of the columns (i.e. the one we observed in the original data) that could have been sampled to obtain a large enough score. Therefore the p-values are somewhere inbetween zero and $10^{-4}$. We assigned such zero-scores to be $10^{-4}$, taking on more type II error while reducing type I error.  Of the ten pairs of clusters, we found statistically-significant ($\alpha=0.05$) correlations in six of them. Using \texttt{hypernetx 1.2.3}  we prepared Figure \ref{fig:setcoveribscorrelation} to visualize which sets of variables had statistically significant multilinear correlation, coloured by the strength of the correlation score \cite{Praggastis2019}.

::: {.callout-tip collapse="true"}
## Relationship Between IID, Exchangeable and Identical in Marginals

As cited above, is a collection of random variables are IID then they are exchangeble. Note that the converse is not true in general. A collection of random variables might be exchangeable but not IID.

Furthermore, if a collection of random variables are exchangeable then they will have the same marginal distribution up to labelling of the variables. The converse is not true in general. It is possible to have a collection of random variables which are identical in their marginal distribution but are not exchangeable.
:::

\begin{figure}[H]
	\centering
	\begin{tabular}{cc}
	\tiny within NL & \tiny NL vs NU \\
	\includegraphics[scale=0.25]{./IBD_figures/hypergraph_NL_vs_NL.pdf} & \includegraphics[scale=0.25]{./IBD_figures/hypergraph_NL_vs_NU.pdf} \\
	\tiny NL vs SW & \tiny NU vs SW \\	
	 \includegraphics[scale=0.25]{./IBD_figures/hypergraph_NL_vs_SW.pdf} & \includegraphics[scale=0.25]{./IBD_figures/hypergraph_NU_vs_SW.pdf} \\
	\tiny SE vs NL & \tiny SE vs NU \\	 
	  \includegraphics[scale=0.25]{./IBD_figures/hypergraph_SE_vs_NL.pdf} & \includegraphics[scale=0.25]{./IBD_figures/hypergraph_SE_vs_NU.pdf} \\
	\end{tabular}
	\caption{Set cover visualizations of multilinear Pearson correlation among sets of variables including \texttt{Host} and the \texttt{residuals} of the IBD linear regression models.}
	\label{fig:setcoveribscorrelation}
\end{figure}

It is apparent from Figure \ref{fig:setcoveribscorrelation} that \texttt{residuals} and \texttt{ln(geo\_dist)} appear to be mutually dependent along with \texttt{Host} within each pair of clusters. Thus the correlationally sufficient exogeneity inferred with the pairwise Pearson correlations did not fully assess independence between the IBD model residuals with the geographical distances when covariates such as differences in host were considered. Rather these multilinear Pearson correlation coefficients suggest that a linear model between \texttt{fst\_scores} and \texttt{ln(geo\_dist)} does not render the genetic distances as independent from \texttt{Host}. This leaves the question of dependence between genetic distance and host selection confounded by geography. This exemplifies how multilinear correlation can be used selectively on different combinations of variables depending on the question of interest.\\

We also noted from  Figure \ref{fig:setcoveribscorrelation} that all six variables occur in only four of the six pairs of clusters included all of the variables. Namely that absolute differences in elevation (\texttt{Elevation}) did not appear to be correlated be correlated with \texttt{residuals} and \texttt{Host} within the within NL and NL vs NU clusters. We speculate based on Figure \ref{fig:elevationdist} that the spatial distribution of elevations might be more similar within and between the northern clusters. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{./IBD_figures/elevation_scatter.pdf}
	\caption{Scatterplot of latitude vs longitude of samples of mountain pine beetle. The points are coloured by bins of elevation.}
	\label{fig:elevationdist}
\end{figure}

Table \ref{tab:shortcorrresults} summarizes the multilinear correlations with absolute scores greater-than-or-equal-to 0.2. The rest of the multilinear Pearson correlations are summarized in tables found in appendix section \ref{sec:summarycorrhost}. Notably only a short list of multilinear correlations make this list, and they are not particularly strong effects on the scale of $[-1,1]$.

\begin{table}[H]
\caption{Condensed summary of permutation tests of multilinear Pearson correlations calculated on collections of variables that included host species and IBD residuals. The results are stratified by cluster pair. The absolute effects sizes are selected to be greater-than-or-equal-to 0.2.}
\tiny
\centering
\begin{tabular}{lllll}
\hline
Cluster Pair &                                                                    Variables &  P-Value$^*$ &     $R$ &  Holm-Sidak \\
 & & & & P-Value\\
\hline
	within NL &                                                            \texttt{Host}, \texttt{residuals} &  0.0001 &  0.295213 &    0.015873 \\
   NL vs SW &                                                            \texttt{Host}, \texttt{residuals} &  0.0001 &  0.245797 &    0.015873 \\
   NL vs SW &                                          \texttt{Precipitation\_PC}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.253056 &    0.015873 \\
   NU vs SW &                                                            \texttt{Host}, \texttt{residuals} &  0.0001 &  0.304575 &    0.015873 \\
   NU vs SW &                                            \texttt{Temperature\_PC}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.298889 &    0.015873 \\
   NU vs SW &                                          \texttt{Precipitation\_PC}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.300972 &    0.015873 \\
   NU vs SW &                                              \texttt{ln(geo\_dist)}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.206326 &    0.015873 \\
   NU vs SW &                         \texttt{Temperature\_PC}, \texttt{Precipitation\_PC}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.219195 &    0.015873 \\
   NU vs SW &                               \texttt{Precipitation\_PC},  \texttt{Elevation}, \texttt{Host}, \texttt{residuals} &  0.0001 & -0.213909 &    0.015873 \\
   SE vs NL &                          \texttt{Temperature\_PC}, \texttt{Precipitation\_PC}, \texttt{Host}, \texttt{residuals} &  0.0001 &  0.221663 &    0.015873 \\
   SE vs NU &                                                           \texttt{Host}, \texttt{residuals} &  0.0002 &  0.205100 &    0.023521 \\
   within SW & \texttt{Host}, \texttt{residuals} & 0.0778 & 0.383154 & 0.995944 \\
\hline
 * $\max (P, 10^{-4})$. & & & & \\
\end{tabular}
\label{tab:shortcorrresults}
\end{table}

## Future Research

The main challenge with testing the conditional independence of host selection and genetic diversity given the dependence on geography is that the dependence between genetic variation and geographical distribution is complicated. In order to account for this dependence, we believe a combination of discrete stratification (i.e. clustering or similar methods) combined with continuous stratification (i.e. regression models) will be required. We offer some discussion of how future research can improve on the modelling we presented in this work. 

### Variable Extraction and Selection

The first aspect we will consider is which variables to use in an IBD model.

For variables representing abstract ideas such as "genetic variability", "genetic differentiation", "genetic distance", "genetic structure" we must extract variables the from original data that operationalize our often-less-precise notions. A couple of the most common genetic disimilarity scores include pairwise Fst\footnote{We caution the reader that different functions are referred to as pairwise Fst. In this analysis we used Fst as calculated in the GenAlEx6.5 documentation.} and Nei's standard genetic distance score. Neither of these functions are distance functions (i.e. metrics) in the mathematicians sense, but they do have useful properties such as identity of indiscernibles and non-negativity that intuitively capture the notion of a `disimilarity score'. The property that they do not have is the triangle inequality, which can be intuitively stated as a `taking a detour requires more distance' property. For example, the distance between Prince George and Vancouver must be less-than-or-equal-to the distance of going from Prince George to some other city (e.g. Edmonton) and then going to Vancouver. If we considered three genetic populations $A$,$B$,$C$, and a distance function between them, $d$, then we would find that $d(A,B) \leq d(A,C) + d(C,B)$. The triangle inequality is a property that can aid in interpretation of the results, and thus we recommend performing a literature search for alternative functions to Fst and Nei's score that satisfy this property.\\

In our model of IBD we assumed that the best way to quantify the geographical distance between two points on the Earth is by the arc length on the surface of a sphere. This is certainly an excellent approximation given that the Earth's surface is even more accurately modelled as an oblate spheroid with a small eccentricity, but we wish to suggest a different motivation for selecting a measurement of distance based on an abstract reason for why IBD should work. The underlying rationale for IBD is that populations that are further away will be more genetically dissimilar because the resources required to travel the distance is a gradual reproductive barrier. This leads us to question what other spatially-relevant factors serve as gradual barriers, and we offer some speculations.  While mountain pine beetle can potentially fly for hours at a time \cite{Evenden2014}, and even be carried by the winds at around 800 m above the tree canopy for 100 kilometers \cite{Jackson2008}, it is not unreasonable to hypothesize that topographical features can serve as gradual barriers. The first hypothesis that we offer is to use surface distances that account for the actual topographically details such as mountains and valleys. One way to achieve this computationally would be to create a weighted graph whose vertices are spatial locations and whose weights are the 3D Euclidean distance. Figure \ref{fig:elevationsurface} provides a low resolution example of such a surface using the provided georeferenced mountain pine beetle data. For such a mesh model with high enough resolution, one could consider the existence of paths through the graph between two points. The shortest path problem is a classic problem from computer science that is often solved by Dijkstra's algorithm \cite{Dijkstra1959} or extensions of it such as A* (@Doran1966, @Dechter1985). These shortest paths on along the surface of Earth might better reflect the graduation of reproductive isolation that exists between populations.

\begin{figure}
	\centering
	\includegraphics[scale=1]{./elevation_plots/view_1.pdf}
	\caption{Three-dimensional embedding of a two-dimensional Delaunay triangulation of geospatial coordinates where mountain pine beetle were sampled. The vertical component for each vertex is given by the elevation (in meters), and the elevation of the faces are linearly interpolated between vertices.}
	\label{fig:elevationsurface}
\end{figure}

Once this local impediment notion is realized for Euclidean distance, one might imagine that more abstract network weights could be devised based on other variables including local climate variables including wind direction, local density of host species, the local density of predators, and the geographical distribution of suitable habitat. Building such surface models requires more work as variables are added and as the resolution of the spatially-embedded graph increases, but it may be an effective way of modelling the non-linear and possibly-non-smooth effects of geography on IBD as mediated through other variables.

### Discrete Stratification

Let us consider the discrete stratification first. It is evident from the NL vs SW subplot in Figure \ref{fig:cluster_regression} that there are separate connected components that were not identified by the STRUCTURE software package, which in that particular subplot appear to be separated primarily by \texttt{fst\_score} axis. However, visual examination of the NU vs SW and SE vs NU subplots are more ambiguous on the existence of additional connected components and by which discriminant function (linear or non-linear) they would be separated by. This motivates finding a new partition of the data. It is not practically possible to exhaustively compute every possible partition of a modestly-sized dataset because the number of partitions on a set is equal to the Bell number for cardinality of that set.  The Bell number of a set of cardinality $n$ is equivalent to adding up all the Stirling numbers of the second kind up to and including $n$ (@weisstein), which can be written as


$$B_n = \sum_{k=0}^{n} \left[ \frac{1}{k!} \sum_{i=0}^{k} (-1)^i {k \choose i} (k-i)^n\right].$$


Clustering algorithms guide the data analyst toward particular choices of partitions of the data, based on a choice of algorithm, parameters, and (usually) a function quantifying similarity or dissimilarity. There are a large number of hard clustering algorithms\footnote{By a \textit{hard} clustering algorithm, we mean one in which a point is placed either in a cluster, or it is not in that cluster, but not both and not neither. In other words, a clustering algorithm find finds a partition of the data set. There are \textit{soft} clustering methods such as fuzzy C means that assign a weight to each pair of points and clusters suggesting 'how much membership' a point has to a given set (@Dunn1973}). including K-means (@steinhaus1957), affinity propagation (@Frey2007), mean-shift (@Comaniciu2002), spectral clustering (@Shi2000), Ward hierarchical clustering (@Ward1963),  density-based spatial clustering of applications with noise (DBSCAN) (@Ester1996), ordering points to identify the clustering structure (OPTICS) (@Ankerst1999), Gaussian mixture models (GMM's; see \cite{pedregosa2011} for examples), and balanced iterative reducing and clustering using hierarchies (BIRCH) \cite{Zhang1996}. The Scikit-Learn Python package provides a useful comparison and contrast of the tradeoffs among these methods in terms of (hyper)parameters, scalability, and assumptions made by each algorithm \cite{pedregosa2011}. Including aforementioned tools such as STRUCTURE \cite{Pritchard2000} and BAPS \cite{Corander2003}, there are other tools in the literature as cited by \cite{Corander2008} which are aimed at modelling genetic structure. We suspect that many of these approaches will also require choices of hyperparameters.  In our opinion, there does not exist a clustering algorithm that is suitable for all use cases and data sets. Therefore we recommend that a quantitative and qualitative exploration of which clustering algorithms best suite this microsatellite data be undergone in future research.

### Continuous Stratification
Now let us consider the continuous stratification approach. After stratifying the data based on the cluster assignment, we can further substratify by a continuous function. In this thesis we tested a na\"ive hypothesis that the IBD effects between the Fst score and geographic log-distance would be linear based on a prevalence of such models in the literature. As shown in Figure \ref{fig:cluster_regression}, the assumption of a linear relationship between the pairwise Fst scores and the natural logarithm of the geographic (i.e. spherical arc-length) distance was poor-to-moderate in fit. The lack of excellent fit could be due to multiple factors. As mentioned above, some of the lack of model success may be attributable to not specifying the right strata. However, in subplots within NU, within SE, and within SW there appears to be substantial influence of (visually-estimated) ouliers even with the use of a Huber loss function to robustify the training. We suspect that the relationship between pairwise Fst scores and the geographic log-distance are non-linear based on visual inspection of the plots in our analysis, but we also believe there are first-principles reasons to expect non-linearity when we consider populations that are extremely close or extremely far away. When populations are relatively close compared to their mobility, we might expect that such distances explain very little genetic variation because they do not serve as a barrier to reproduction. The other extreme is when the populations are already so far away that they are very rarely interbreeding, in which case moderate variations in their geographical distance may have a smaller effect than if they were only moderately far away compared to their mobility. The notion that IBD effects have smaller sensitivity at very small distances and very large distances, but with a more sensitive range of distances in-between, suggests non-linearities such as can be found with S-shaped curves. Such curves are common in nature, from population dynamics to levels of gene transcription. Some of the S-shaped curves that might be used in future research include the Verhulst model (@Bacar2011), monod function (@Monod1949), Gomperz function (@Gomperz1825), Von Bertalanffy's equation (@pauly1987), Richard's curve (i.e. the generalized logistic growth function) (@Richards1959), and the hyperbolastic functions of types I, II, and III (@Tabatabai2005).

## Conclusions

In this application we showed how multilinear Pearson correlation can be used in model evaluation. The existence of measure dependence between the residuals of the IBD models with geographical distance after partialling suggests that the models tested here are not correlationally sufficient for the exogeneity assumption. Our results suggest that there may be measure dependence between differences in host choice and pairwise Fst scores, however these correlations are still confounded by geographical distance. We provided multiple avenues for improving the IBD models in future research, and exemplified how correlational sufficiency can be used in future model evaluations.
